<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نور الإسلام | موقع إسلامي شامل</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&family=Amiri:wght@400;700&family=Aref+Ruqaa:wght@400;700&family=Amiri+Quran&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <!-- Meta tags for SEO -->
    <meta name="description" content="موقع نور الإسلام - موقع إسلامي شامل يحتوي على الأذكار، أوقات الصلاة، حاسبة الزكاة، المسبحة الإلكترونية، والمزيد من المحتوى الإسلامي">
    <meta name="keywords" content="إسلام، أذكار، قرآن، صلاة، زكاة، مسبحة، أدعية، إسلامي">
    <!-- LeafletJS for Mosques Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="stylesheet" href="mosques.css">
</head>
<body>
    <!-- الهيدر والقائمة -->
    <header class="main-header">
        <div class="nav-container">
            <div class="logo">
                <h1><i class="fas fa-mosque"></i> نور الإسلام</h1>
            </div>
            <nav class="nav-links">
                <button class="nav-btn active" data-section="home-section" title="الرئيسية">
                    <i class="fas fa-home"></i>
                </button>
                <button class="nav-btn" data-section="azkar-section" title="الأذكار">
                    <i class="fas fa-book-open"></i>
                </button>
                <button class="nav-btn" data-section="prayer-times" title="أوقات الصلاة">
                    <i class="fas fa-clock"></i>
                </button>
                <button class="nav-btn" data-section="quran-section" title="القرآن الكريم">
                    <i class="fas fa-quran"></i>
                </button>
                <button class="nav-btn" data-section="tasbih-section" title="المسبحة">
                    <i class="fas fa-pray"></i>
                </button>
                <button class="nav-btn" data-section="radio-section" title="الإذاعة">
                    <i class="fas fa-broadcast-tower"></i>
                </button>
                <button class="nav-btn" data-section="kaaba-live-section" title="بث مباشر من الكعبة">
                    <i class="fas fa-kaaba"></i>
                </button>
                <button class="nav-btn" data-section="qibla-section" title="اتجاه القبلة">
                    <i class="fas fa-compass"></i>
                </button>
                <button class="nav-btn" data-section="mosques-section" title="دليل المساجد">
                    <i class="fas fa-map-marked-alt"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- القسم الرئيسي -->
    <section id="home-section" class="content-section active">
        <div class="hero-section">
            <div class="hero-content">
                <h1>بسم الله الرحمن الرحيم</h1>
                <h2>مرحباً بكم في موقع نور الإسلام</h2>
                <p>موقع إسلامي شامل يقدم لكم مجموعة من الخدمات الإسلامية المتنوعة</p>
                <div class="feature-cards">
                    <div class="feature-card">
                        <i class="fas fa-clock"></i>
                        <h3>مواقيت الصلاة</h3>
                        <p>تعرف على أوقات الصلاة في مدينتك بدقة</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-quran"></i>
                        <h3>القرآن الكريم</h3>
                        <p>قراءة وتلاوة القرآن الكريم</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-map-marked-alt"></i>
                        <h3>دليل المساجد</h3>
                        <p>اعثر على أقرب المساجد إليك بسهولة</p>
                    </div>
                </div>
                <div class="daily-verse">
                    <h3>آية اليوم</h3>
                    <div class="verse-content">
                        <p class="verse-text" id="daily-verse-text">﴿...﴾</p>
                        <p class="verse-surah" id="daily-verse-surah">...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- قسم الأذكار المطور -->
    <section id="azkar-section" class="content-section">
        <h2 class="section-title">حصن المسلم</h2>
        <audio id="azkar-audio-player" style="display:none;"></audio>
        <div class="azkar-container-new">
            <div class="azkar-sidebar">
                <div class="azkar-search-new">
                    <i class="fas fa-search"></i>
                    <input type="text" id="azkar-search-input" placeholder="ابحث في الأذكار...">
                </div>
                <div id="azkar-categories-list">
                    <!-- Category buttons will be generated here by JS -->
                </div>
            </div>
            <div class="azkar-main-content">
                <div class="azkar-header">
                    <h3 id="current-category-title"></h3>
                    <div class="azkar-progress-container">
                        <span>التقدم</span>
                        <div class="progress-bar">
                            <div id="azkar-progress-bar-fill" style="width: 0%;"></div>
                        </div>
                        <span id="azkar-progress-text">0/0</span>
                    </div>
                </div>
                <div id="azkar-content" class="azkar-content-new">
                     <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>جاري التحميل...</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- قسم أوقات الصلاة -->
    <section id="prayer-times" class="content-section">
        <div class="prayer-container-modern">
            <div class="prayer-main-display">
                <div id="prayer-initial-prompt" class="prayer-initial-prompt">
                    <i class="fas fa-globe-asia"></i>
                    <h2>أوقات الصلاة حول العالم</h2>
                    <p>ابدأ بتحديد موقعك لعرض أوقات الصلاة الدقيقة.</p>
                    <p class="prompt-hint">استخدم القائمة لاختيار دولتك ومدينتك، أو اسمح للمتصفح بتحديد موقعك تلقائياً.</p>
                </div>

                <div id="prayer-main-content" class="hidden">
                    <div class="location-and-date">
                        <h3 id="prayer-location-display"><i class="fas fa-map-marker-alt"></i> <span>جاري تحديد الموقع...</span></h3>
                        <p id="hijri-date-display">التاريخ الهجري</p>
                    </div>
                    <div class="next-prayer-info-modern">
                        <p>الصلاة القادمة</p>
                        <h2 id="next-prayer-name">--</h2>
                    </div>
                    <div id="countdown-timer" class="countdown-timer">
                        <div class="time-part seconds">
                            <svg class="countdown-svg" viewBox="0 0 100 100">
                                <circle class="countdown-bg-circle" cx="50" cy="50" r="45"></circle>
                                <circle id="countdown-s-ring" class="countdown-fg-circle" cx="50" cy="50" r="45"></circle>
                            </svg>
                            <div class="time-text">
                                <span id="countdown-s">00</span>
                                <small>ثانية</small>
                            </div>
                        </div>
                        <div class="time-part minutes">
                             <svg class="countdown-svg" viewBox="0 0 100 100">
                                <circle class="countdown-bg-circle" cx="50" cy="50" r="45"></circle>
                                <circle id="countdown-m-ring" class="countdown-fg-circle" cx="50" cy="50" r="45"></circle>
                            </svg>
                            <div class="time-text">
                                <span id="countdown-m">00</span>
                                <small>دقيقة</small>
                            </div>
                        </div>
                        <div class="time-part hours">
                             <svg class="countdown-svg" viewBox="0 0 100 100">
                                <circle class="countdown-bg-circle" cx="50" cy="50" r="45"></circle>
                                <circle id="countdown-h-ring" class="countdown-fg-circle" cx="50" cy="50" r="45"></circle>
                            </svg>
                            <div class="time-text">
                                <span id="countdown-h">00</span>
                                <small>ساعة</small>
                            </div>
                        </div>
                    </div>
                    <div class="prayer-timeline">
                        <!-- سيتم تعبئتها بواسطة JS -->
                    </div>
                </div>
            </div>

            <div class="prayer-sidebar">
                <div class="location-controls-modern">
                    <h4><i class="fas fa-map-location-dot"></i> تغيير الموقع</h4>
                    <select id="country-select" class="location-input-modern">
                        <option value="" disabled selected>اختر دولتك</option>
                        <option value="SA">المملكة العربية السعودية</option>
                        <option value="EG">مصر</option>
                        <option value="AE">الإمارات العربية المتحدة</option>
                        <option value="KW">الكويت</option>
                        <option value="QA">قطر</option>
                        <option value="BH">البحرين</option>
                        <option value="OM">عمان</option>
                        <option value="JO">الأردن</option>
                        <option value="PS">فلسطين</option>
                        <option value="LB">لبنان</option>
                        <option value="SY">سوريا</option>
                        <option value="IQ">العراق</option>
                    </select>
                    <select id="city-select" class="location-input-modern">
                        <!-- سيتم تعبئتها بواسطة JS -->
                    </select>
                </div>
                <div class="all-prayer-times">
                    <h4><i class="fas fa-calendar-day"></i> أوقات اليوم</h4>
                    <ul id="prayer-times-list">
                        <!-- سيتم تعبئتها بواسطة JS -->
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- قسم القرآن الكريم المطور -->
    <section id="quran-section" class="content-section">
        <div id="quran-container-reimagined">
            <!-- Surah List View -->
            <div id="quran-surah-list-view">
                <div class="quran-header-bar">
                    <h2 class="section-title">القرآن الكريم</h2>
                    <div class="quran-search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" id="quran-search-input-new" placeholder="ابحث عن سورة...">
                    </div>
                </div>
                <div id="quran-last-read" class="quran-last-read hidden">
                    <!-- Last Read content will be here -->
                </div>
                 <div class="quran-view-tabs">
                    <button class="tab-btn active" data-view="surah">السور</button>
                    <button class="tab-btn" data-view="juz">الأجزاء</button>
                </div>
                <div id="quran-surah-grid" class="quran-surah-grid quran-grid-view active">
                    <!-- Skeleton loaders or Surah cards will be here -->
                </div>
                 <div id="quran-juz-list" class="quran-juz-list quran-grid-view">
                    <!-- Skeleton loaders or Juz list will be here -->
                </div>
            </div>
    
            <!-- Reader View -->
            <div id="quran-reader-view" class="hidden">
                <div class="reader-header-new">
                    <button id="reader-back-btn" class="reader-header-btn" title="العودة"><i class="fas fa-arrow-right"></i></button>
                    <div class="reader-surah-title">
                        <h3 id="reader-surah-name"></h3>
                        <p id="reader-surah-info"></p>
                    </div>
                    <button id="reader-settings-toggle" class="reader-header-btn" title="إعدادات النص"><i class="fas fa-cog"></i></button>
                </div>
                <div id="reader-settings-panel" class="reader-settings-panel hidden">
                    <div class="setting-group">
                        <label for="font-family-select">الخط:</label>
                        <select id="font-family-select">
                            <option value="'Amiri Quran', serif">الخط الأميري للقرآن</option>
                            <option value="'Amiri', serif">أميري</option>
                            <option value="'Tajawal', sans-serif">تجوال</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label>حجم الخط:</label>
                        <button id="font-size-decrease" class="setting-btn" title="تصغير الخط"><i class="fas fa-minus"></i></button>
                        <span id="font-size-display">100%</span>
                        <button id="font-size-increase" class="setting-btn" title="تكبير الخط"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
                <div id="reader-content" class="reader-content">
                    <!-- Bismillah and Ayahs will be generated here -->
                </div>
                <div id="reader-audio-player" class="reader-audio-player-new" style="display: none;">
                     <div class="player-info">
                        <div id="player-surah-name"></div>
                        <div id="player-reciter-name"></div>
                     </div>
                     <audio id="continuous-audio-player" controls></audio>
                     <div class="reciter-selection">
                        <i class="fas fa-user-circle"></i>
                        <select id="reader-reciter-select">
                            <!-- Reciters populated by JS -->
                        </select>
                     </div>
                </div>
            </div>
        </div>
    
        <!-- Tafsir Modal -->
        <div id="tafsir-modal" class="modal-container hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="tafsir-modal-title"></h3>
                    <button id="tafsir-modal-close" class="modal-close-btn">&times;</button>
                </div>
                <div id="tafsir-modal-body" class="modal-body">
                    <!-- Tafsir text will be loaded here -->
                </div>
            </div>
        </div>
    </section>

    <!-- قسم المسبحة الإلكترونية المطور -->
    <section id="tasbih-section" class="content-section">
        <h2 class="section-title">المسبحة الرقمية</h2>
        <div class="tasbih-pro-container">
            
            <!-- العداد الرئيسي -->
            <div class="tasbih-counter-area">
                <div class="tasbih-goal-progress">
                    <svg width="280" height="280" viewBox="0 0 280 280">
                        <circle class="progress-ring-bg" cx="140" cy="140" r="130"></circle>
                        <circle id="tasbih-progress-ring" class="progress-ring-fg" cx="140" cy="140" r="130"></circle>
                    </svg>
                </div>
                <div class="tasbih-display-pro">
                    <div id="tasbih-score-pro">0</div>
                    <div id="tasbih-goal-display">الهدف: 33</div>
                </div>
                <div id="tasbih-main-button">
                    <span id="tasbih-main-text">سبحان الله</span>
                </div>
            </div>
    
            <!-- لوحة التحكم -->
            <div class="tasbih-controls-panel">
                <div class="control-group main-controls">
                    <button id="tasbih-reset-pro" class="control-btn" title="إعادة تعيين"><i class="fas fa-undo"></i></button>
                    <button id="tasbih-sound-toggle" class="control-btn active" title="كتم/تشغيل الصوت"><i class="fas fa-volume-up"></i></button>
                    <button id="tasbih-auto-toggle" class="control-btn" title="تسبيح تلقائي"><i class="fas fa-robot"></i></button>
                </div>
                <div id="tasbih-auto-controls" class="control-group speed-controls hidden">
                    <label>السرعة:</label>
                    <button class="speed-btn" data-speed="2000">بطيء</button>
                    <button class="speed-btn active" data-speed="1000">وسط</button>
                    <button class="speed-btn" data-speed="500">سريع</button>
                </div>
                <div class="control-group goal-controls">
                    <label>الهدف:</label>
                    <button class="goal-btn active" data-goal="33">33</button>
                    <button class="goal-btn" data-goal="100">100</button>
                    <button class="goal-btn" data-goal="1000">1000</button>
                    <button class="goal-btn" data-goal="0">∞</button>
                </div>
            </div>
            
            <!-- قائمة التسبيحات -->
            <div class="tasbih-presets-container">
                <h3>اختر تسبيحة</h3>
                <div class="tasbih-presets-scroller">
                    <button class="preset-btn-pro active" data-text="سبحان الله">سبحان الله</button>
                    <button class="preset-btn-pro" data-text="الحمد لله">الحمد لله</button>
                    <button class="preset-btn-pro" data-text="الله أكبر">الله أكبر</button>
                    <button class="preset-btn-pro" data-text="لا إله إلا الله">لا إله إلا الله</button>
                    <button class="preset-btn-pro" data-text="أستغفر الله">أستغفر الله</button>
                    <button class="preset-btn-pro" data-text="لا حول ولا قوة إلا بالله">لا حول ولا قوة إلا بالله</button>
                    <button class="preset-btn-pro" data-text="سبحان الله وبحمده">سبحان الله وبحمده</button>
                    <button class="preset-btn-pro" data-text="سبحان الله العظيم">سبحان الله العظيم</button>
                    <button class="preset-btn-pro" data-text="اللهم صل على محمد">اللهم صل على محمد</button>
                    <button class="preset-btn-pro" data-text="حسبي الله ونعم الوكيل">حسبي الله ونعم الوكيل</button>
                </div>
            </div>
    
        </div>
        <audio id="tasbih-click-sound" src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAEw//k0//lE//l0//mY//nE//n0//oY//p0//qg//rQ//sA//tI//uA//uw//vY//wQ//ww//x4//z4//0Q//1o//24//3w//4o//54//7A//8A//9Q//+I//+w//gA=" preload="auto"></audio>
    </section>

    <!-- قسم البث المباشر من الكعبة -->
    <section id="kaaba-live-section" class="content-section">
        <h2 class="section-title">البث المباشر من الحرمين الشريفين</h2>
        <div class="live-broadcast-wrapper">
            <div class="main-broadcast-panel">
                <div class="video-player-container">
                    <iframe 
                        id="live-stream-iframe"
                        src="https://www.youtube.com/embed/zIl0NYIsBCE?autoplay=1&mute=1" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>
                <div class="broadcast-info-panel">
                    <h3 id="info-panel-title">مكة مباشر</h3>
                    <p id="info-panel-text">بث مباشر على مدار الساعة من مكة المكرمة.</p>
                </div>
            </div>
            <div class="broadcast-sidebar">
                <div class="stream-selector">
                    <h4><i class="fas fa-tv"></i> اختر البث</h4>
                    <div class="stream-option active" data-stream="makkah_live">
                        <i class="fas fa-satellite-dish stream-icon"></i>
                        <div class="option-text">
                            <h5>مكة مباشر</h5>
                            <span>بث مباشر على مدار الساعة</span>
                        </div>
                    </div>
                    <div class="stream-option" data-stream="al_haram">
                        <i class="fas fa-mosque stream-icon"></i>
                        <div class="option-text">
                            <h5>المسجد الحرام</h5>
                            <span>بث من الحرم المكي</span>
                        </div>
                    </div>
                    <div class="stream-option" data-stream="kaaba_live">
                        <i class="fas fa-kaaba stream-icon"></i>
                        <div class="option-text">
                            <h5>الكعبة مباشر</h5>
                            <span>بث مباشر للكعبة المشرفة</span>
                        </div>
                    </div>
                    <div class="stream-option" data-stream="quran">
                        <i class="fas fa-quran stream-icon"></i>
                         <div class="option-text">
                            <h5>قناة القرآن الكريم</h5>
                            <span>بث تلاوات عطرة</span>
                        </div>
                    </div>
                </div>
                <div class="makkah-prayer-times-widget">
                     <h3><i class="fas fa-clock"></i> الصلاة في مكة</h3>
                     <div class="prayer-times-content">
                        <div class="loading-spinner">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                     </div>
                </div>
            </div>
        </div>
    </section>

    <!-- قسم اتجاه القبلة -->
    <section id="qibla-section" class="content-section">
        <h2 class="section-title">اتجاه القبلة</h2>
        <div class="qibla-container-new">
            <div class="qibla-map-area">
                <div id="qibla-map">
                     <div class="map-placeholder">
                        <i class="fas fa-map-marked-alt"></i>
                        <p>سيتم عرض الخريطة هنا بعد تحديد موقعك</p>
                    </div>
                </div>
            </div>
            <div class="qibla-info-panel">
                <h3><i class="fas fa-compass"></i> معلومات القبلة</h3>
                <div id="qibla-results">
                    <p class="initial-message">اضغط على الزر أدناه لبدء تحديد اتجاه القبلة.</p>
                </div>
                <div class="qibla-controls">
                    <button id="get-location" class="qibla-btn">
                        <i class="fas fa-location-arrow"></i> تحديد موقعي
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- قسم الإذاعة -->
    <section id="radio-section" class="content-section">
        <h2 class="section-title">الإذاعة الإسلامية</h2>
        <div class="radio-container">
            <div class="radio-main-content">
                <div class="radio-list-panel">
                    <div class="radio-search">
                        <i class="fas fa-search"></i>
                        <input type="text" id="radio-search-input" placeholder="ابحث عن إذاعة...">
                    </div>
                    <div class="featured-stations-wrapper">
                        <h3><i class="fas fa-star"></i> إذاعات مميزة</h3>
                        <div class="featured-stations" id="featured-stations-container">
                        </div>
                    </div>
                    <div class="radio-categories" id="radio-categories-container">
                    </div>
                    <div class="radio-stations" id="radio-stations-container">
                        <div class="loading-spinner">
                            <i class="fas fa-spinner fa-spin"></i> جاري تحميل الإذاعات...
                        </div>
                    </div>
                </div>
                <div class="radio-player-panel">
                    <div class="radio-player">
                        <div class="station-artwork-new" id="station-artwork-new">
                            <i class="fas fa-broadcast-tower"></i>
                        </div>
                        <div class="station-info">
                            <h3 id="current-station-name">اختر إذاعة للبدء</h3>
                            <p id="current-station-desc">استمع للقرآن الكريم مباشرة</p>
                        </div>
                        <canvas id="visualizer"></canvas>
                        <div class="player-controls">
                            <button id="radio-play-btn" class="player-btn" disabled title="تشغيل/إيقاف مؤقت"><i class="fas fa-play"></i></button>
                            <div class="volume-control">
                                <i id="volume-icon" class="fas fa-volume-up"></i>
                                <input type="range" id="volume-slider" min="0" max="100" value="70" title="التحكم في الصوت">
                            </div>
                            <button id="radio-stop-btn" class="player-btn" disabled title="إيقاف"><i class="fas fa-stop"></i></button>
                        </div>
                        <audio id="radio-audio" style="display: none;"></audio>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- قسم دليل المساجد -->
    <section id="mosques-section" class="content-section">
        <h2 class="section-title">دليل المساجد القريبة</h2>
        <div class="mosques-content-wrapper">
            <div class="app-controls">
                <div class="location-controls">
                    <button id="locate-btn" class="btn locate-btn">
                        <i class="fas fa-location-crosshairs"></i> تحديد موقعي
                    </button>
                    <div class="range-control">
                        <label for="radius">نطاق البحث:</label>
                        <input type="range" id="radius" min="0.5" max="10" step="0.5" value="2">
                        <span id="radius-value">2 كم</span>
                    </div>
                </div>
            </div>

            <div class="map-container">
                <div id="map"></div>
                <div class="map-actions">
                    <button id="zoom-in" class="map-btn"><i class="fas fa-plus"></i></button>
                    <button id="zoom-out" class="map-btn"><i class="fas fa-minus"></i></button>
                    <button id="current-loc" class="map-btn"><i class="fas fa-location-arrow"></i></button>
                </div>
            </div>

            <div class="results-container">
                <div class="results-header">
                    <h2><i class="fas fa-list"></i> قائمة المساجد</h2>
                    <span id="results-count">0 مسجد</span>
                </div>
                <div class="mosques-list" id="mosques-list">
                    <p class="no-results">الرجاء تحديد موقعك لعرض المساجد القريبة</p>
                </div>
            </div>

            <div class="prayer-times-mosques" id="prayer-times-mosques">
                <h3><i class="fas fa-clock"></i> أوقات الصلاة لموقعك الحالي</h3>
                <div class="times-grid">
                    <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin"></i> يرجى تحديد موقعك لعرض الأوقات
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="main-footer-social">
        <div class="footer-content">
            <h3>تابعنا على</h3>
            <div class="social-links">
                <a href="https://youtube.com/@noor_al_islame" target="_blank" rel="noopener noreferrer" title="يوتيوب">
                    <i class="fab fa-youtube"></i>
                </a>
                <a href="https://www.tiktok.com/@noor_al__islam" target="_blank" rel="noopener noreferrer" title="تيك توك">
                    <i class="fab fa-tiktok"></i>
                </a>
            </div>
            <p class="copyright">&copy; 2024 نور الإسلام. جميع الحقوق محفوظة.</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script src="prayer.js"></script>
    <script src="quran.js"></script>
    <script src="qibla.js"></script>
    <script src="azkar.js"></script>
    <script src="radio.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="mosques.js"></script>
    <script src="dailyVerse.js"></script>
    <audio id="azkar-click-sound" src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAEw//k0//lE//l0//mY//nE//n0//oY//p0//qg//rQ//sA//tI//uA//uw//vY//wQ//ww//x4//z4//0Q//1o//24//3w//4o//54//7A//8A//9Q//+I//+w//gA=" preload="auto"></audio>
    <script>
        // كود البث المباشر من الكعبة
        document.addEventListener("DOMContentLoaded", function() {
            // Check if we are on the Kaaba section before running the code
            if (!document.getElementById('kaaba-live-section')) return;

            const streamOptions = document.querySelectorAll('#kaaba-live-section .stream-option');
            const iframe = document.getElementById('live-stream-iframe');
            const infoTitle = document.getElementById('info-panel-title');
            const infoText = document.getElementById('info-panel-text');
            const prayerTimesContainer = document.querySelector('.prayer-times-content');
            
            const streamData = {
                makkah_live: {
                    url: "https://www.youtube.com/embed/zIl0NYIsBCE?autoplay=1&mute=1",
                    title: "مكة مباشر",
                    text: "بث مباشر على مدار الساعة من مكة المكرمة."
                },
                al_haram: {
                    url: "https://www.youtube.com/embed/yBuMRKLHDK0?autoplay=1&mute=1",
                    title: "المسجد الحرام",
                    text: "بث مباشر من المسجد الحرام."
                },
                kaaba_live: {
                    url: "https://www.youtube.com/embed/-PR51PBK_yY?autoplay=1&mute=1",
                    title: "الكعبة مباشر",
                    text: "بث مباشر للكعبة المشرفة."
                },
                quran: {
                    url: "https://www.youtube.com/watch?v=3OMrH7Lk",
                    title: "قناة القرآن الكريم",
                    text: "بث مباشر على مدار الساعة لتلاوات عطرة من القرآن الكريم بأصوات نخبة من أشهر القراء."
                }
            };
            
            streamOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const streamKey = this.dataset.stream;
                    const data = streamData[streamKey];
                    
                    if (data) {
                        if (streamKey === 'quran') {
                            window.open(data.url, '_blank');
                        } else {
                            iframe.src = data.url;
                            infoTitle.textContent = data.title;
                            infoText.textContent = data.text;
                            
                            streamOptions.forEach(opt => opt.classList.remove('active'));
                            this.classList.add('active');
                        }
                    }
                });
            });
            
            function convertToMinutes(timeString) {
                if (!timeString) return 0;
                const [hours, minutes] = timeString.split(':').map(Number);
                return hours * 60 + minutes;
            }

            async function fetchMakkahPrayerTimes() {
                try {
                    const response = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=Mecca&country=SA&method=4`);
                    if (!response.ok) throw new Error('Network response was not ok');
                    
                    const data = await response.json();
                    if (data.code === 200 && data.status === 'OK') {
                        const timings = data.data.timings;
                        const date = data.data.date;
                        
                        const prayerSchedule = [
                            { name: 'الفجر', nameEn: 'Fajr', time: convertToMinutes(timings.Fajr) },
                            { name: 'الشروق', nameEn: 'Sunrise', time: convertToMinutes(timings.Sunrise) },
                            { name: 'الظهر', nameEn: 'Dhuhr', time: convertToMinutes(timings.Dhuhr) },
                            { name: 'العصر', nameEn: 'Asr', time: convertToMinutes(timings.Asr) },
                            { name: 'المغرب', nameEn: 'Maghrib', time: convertToMinutes(timings.Maghrib) },
                            { name: 'العشاء', nameEn: 'Isha', time: convertToMinutes(timings.Isha) }
                        ];

                        const now = new Date();
                        const currentTime = now.getHours() * 60 + now.getMinutes();
                        let nextPrayer = null;

                        for (const prayer of prayerSchedule) {
                            if (prayer.time > currentTime) {
                                nextPrayer = prayer;
                                break;
                            }
                        }
                        if (!nextPrayer) {
                            nextPrayer = prayerSchedule[0]; // Next prayer is Fajr tomorrow
                        }
                        
                        prayerTimesContainer.innerHTML = `
                            <div class="makkah-date">${date.hijri.day} ${date.hijri.month.ar} ${date.hijri.year} هـ</div>
                            <div class="makkah-prayers-grid">
                                ${prayerSchedule.map(p => `
                                    <div class="makkah-prayer-item ${p.nameEn === nextPrayer.nameEn ? 'next' : ''}">
                                        <span class="prayer-name">${p.name}</span>
                                        <span class="prayer-time">${timings[p.nameEn]}</span>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    } else {
                        throw new Error('Invalid data from API');
                    }
                } catch (error) {
                    console.error('Error fetching Makkah prayer times:', error);
                    prayerTimesContainer.innerHTML = '<div class="error-message">تعذر تحميل أوقات الصلاة</div>';
                }
            }
            
            fetchMakkahPrayerTimes();
            setInterval(fetchMakkahPrayerTimes, 60000); // Refresh every minute
        });
    </script>
</body>
</html>